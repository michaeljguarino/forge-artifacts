apiVersion: v1
kind: Service
metadata:
  name: direct-csi-min-io
  labels:
    {{- include "directpv.labels" . | nindent 4 }}
spec:
  type: {{ .Values.controller.service.type }}
  ports:
    - port: {{ .Values.controller.service.convWebhook.port }}
      targetPort: convwebhook
      protocol: TCP
      name: convwebhook
  selector:
    {{- include "directpv-common.selectorLabels" . | nindent 4 }}
{{- if .Values.controller.validatingWebhook.enabled }}
---
apiVersion: v1
kind: Service
metadata:
  annotations:
    rbac.authorization.kubernetes.io/autoupdate: "true"
  creationTimestamp: null
  labels:
    {{- include "directpv.labels" . | nindent 4 }}
  name: directcsi-validation-controller
spec:
  type: {{ .Values.controller.service.type }}
  ports:
    - port: {{ .Values.controller.service.valWebhook.port }}
      targetPort: validatinghook
      protocol: TCP
      name: validatinghook
  selector:
    {{- include "directpv-deployment.selectorLabels" . | nindent 4 }}
{{- end }}
---
apiVersion: v1
kind: Service
metadata:
  name: direct-csi-min-io-metrics
  labels:
    {{- include "directpv.labels" . | nindent 4 }}
spec:
  type: {{ .Values.daemonSet.service.type }}
  ports:
    - port: {{ .Values.daemonSet.service.metrics.port }}
      targetPort: metrics
      protocol: TCP
      name: metrics
  selector:
    {{- include "directpv-daemonset.selectorLabels" . | nindent 4 }}
